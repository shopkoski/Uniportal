// Translation system for Uni Portal
const translations = {
    en: {
        // Header
        "uni_portal": "Uni Portal",
        "login": "Log in",
        "logout": "Log out",
        
        // Welcome section
        "welcome_title": "Welcome to Uni Portal",
        "welcome_subtitle": "Your academic management system",
        
        // Stats section
        "total_students": "Total Students",
        "available_courses": "Available Courses",
        "professors": "Professors",
        "enrollments": "Enrollments",
        
        // Navigation grid
        "home": "Home",
        "home_subtitle": "Return to dashboard",
        "students": "Students",
        "students_subtitle": "Manage student records",
        "courses": "Courses",
        "courses_subtitle": "View course catalog",
        "grades": "Grades",
        "grades_subtitle": "Check academic performance",
        "professor": "Professor",
        "professor_subtitle": "Faculty information",
        "contact": "Contact",
        "contact_subtitle": "Get in touch",
        
        // Footer
        "copyright": "© 2024 Company. All Rights Reserved.",
        
        // Modal titles
        "course_details": "Course Details",
        "student_course_details": "Student Course Details",
        "professor_course_details": "Professor Course Details",
        
        // Table headers
        "course_id": "Course ID",
        "course_name": "Course Name",
        "credits": "Credits",
        "enrolled_students": "Enrolled Students",
        "actions": "Actions",
        "view": "View",
        "student_id": "Student ID",
        "full_name": "Full Name",
        "email": "Email",
        "enrollment_year": "Enrollment Year",
        "courses": "Courses",
        "professor_id": "Professor ID",
        "department": "Department",
        "courses_taught": "Courses Taught",
        "grade": "Grade",
        "letter_grade": "Letter Grade",
        "professor": "Professor",
        "professor_email": "Professor Email",
        
        // Modal content
        "not_assigned": "Not assigned",
        "students": "Students",
        "enrolled_courses": "Enrolled Courses",
        "enrolled_students": "Enrolled Students",
        "courses_taught_count": "Courses Taught",
        "course": "Course",
        
        // Loading and error messages
        "loading_course_details": "Loading course details...",
        "loading_student_details": "Loading student course details...",
        "loading_professor_details": "Loading professor course details...",
        "error_loading": "Error loading details:",
        "error": "Error:",
        
        // Logout
        "logout": "Logout",
        "logout_with_user": "Logout\n({name} - {role})",
        "role_admin": "Admin",
        "role_student": "Student"
    },
    
    mk: {
        // Header
        "uni_portal": "Универзитетски Портал",
        "login": "Најавете се",
        "logout": "Одјавете се",
        
        // Welcome section
        "welcome_title": "Добредојдовте во Универзитетскиот Портал",
        "welcome_subtitle": "Вашиот систем за управување со академски активности",
        
        // Stats section
        "total_students": "Вкупно Студенти",
        "available_courses": "Достапни Курсеви",
        "professors": "Професори",
        "enrollments": "Запишувања",
        
        // Navigation grid
        "home": "Почетна",
        "home_subtitle": "Вратете се на контролната табла",
        "students": "Студенти",
        "students_subtitle": "Управувајте со студентски записи",
        "courses": "Курсеви",
        "courses_subtitle": "Прегледајте каталог на курсеви",
        "grades": "Оценки",
        "grades_subtitle": "Проверете ја академската изведба",
        "professor": "Професор",
        "professor_subtitle": "Информации за факултетот",
        "contact": "Контакт",
        "contact_subtitle": "Странете во контакт",
        
        // Footer
        "copyright": "© 2024 Компанија. Сите права задржани.",
        
        // Modal titles
        "course_details": "Детали за Курсот",
        "student_course_details": "Детали за Студентски Курсеви",
        "professor_course_details": "Детали за Професорски Курсеви",
        
        // Table headers
        "course_id": "ID на Курс",
        "course_name": "Име на Курс",
        "credits": "Кредити",
        "enrolled_students": "Запишани Студенти",
        "actions": "Акции",
        "view": "Преглед",
        "student_id": "ID на Студент",
        "full_name": "Цело Име",
        "email": "Е-пошта",
        "enrollment_year": "Година на Запишување",
        "courses": "Курсеви",
        "professor_id": "ID на Професор",
        "department": "Одделение",
        "courses_taught": "Предавани Курсеви",
        "grade": "Оценка",
        "letter_grade": "Буквена Оценка",
        "professor": "Професор",
        "professor_email": "Е-пошта на Професор",
        
        // Modal content
        "not_assigned": "Не е доделен",
        "students": "Студенти",
        "enrolled_courses": "Запишани Курсеви",
        "enrolled_students": "Запишани Студенти",
        "courses_taught_count": "Предавани Курсеви",
        "course": "Курс",
        
        // Loading and error messages
        "loading_course_details": "Се вчитуваат деталите за курсот...",
        "loading_student_details": "Се вчитуваат деталите за студентските курсеви...",
        "loading_professor_details": "Се вчитуваат деталите за професорските курсеви...",
        "error_loading": "Грешка при вчитување на деталите:",
        "error": "Грешка:",
        
        // Logout
        "logout": "Одјавете се",
        "logout_with_user": "Одјавете се\n({name} - {role})",
        "role_admin": "Админ",
        "role_student": "Студент"
    },
    
    al: {
        // Header
        "uni_portal": "Portali Universitar",
        "login": "Hyr",
        "logout": "Dil",
        
        // Welcome section
        "welcome_title": "Mirëseerdhët në Portalin Universitar",
        "welcome_subtitle": "Sistemi juaj i menaxhimit akademik",
        
        // Stats section
        "total_students": "Totali i Studentëve",
        "available_courses": "Kurse të Disponueshme",
        "professors": "Profesorë",
        "enrollments": "Regjistrime",
        
        // Navigation grid
        "home": "Kryesore",
        "home_subtitle": "Kthehu në panelin e kontrollit",
        "students": "Studentë",
        "students_subtitle": "Menaxho të dhënat e studentëve",
        "courses": "Kurse",
        "courses_subtitle": "Shiko katalogun e kurseve",
        "grades": "Nota",
        "grades_subtitle": "Kontrollo performancën akademike",
        "professor": "Profesor",
        "professor_subtitle": "Informacione për fakultetin",
        "contact": "Kontakt",
        "contact_subtitle": "Na kontaktoni",
        
        // Footer
        "copyright": "© 2024 Kompania. Të gjitha të drejtat e rezervuara.",
        
        // Modal titles
        "course_details": "Detajet e Kursit",
        "student_course_details": "Detajet e Kurseve të Studentit",
        "professor_course_details": "Detajet e Kurseve të Profesorit",
        
        // Table headers
        "course_id": "ID e Kursit",
        "course_name": "Emri i Kursit",
        "credits": "Kredite",
        "enrolled_students": "Studentë të Regjistruar",
        "actions": "Veprime",
        "view": "Shiko",
        "student_id": "ID e Studentit",
        "full_name": "Emri i Plotë",
        "email": "Email",
        "enrollment_year": "Viti i Regjistrimit",
        "courses": "Kurse",
        "professor_id": "ID e Profesorit",
        "department": "Departamenti",
        "courses_taught": "Kurse të Mësuara",
        "grade": "Nota",
        "letter_grade": "Nota me Shkronja",
        "professor": "Profesor",
        "professor_email": "Email i Profesorit",
        
        // Modal content
        "not_assigned": "Nuk është caktuar",
        "students": "Studentë",
        "enrolled_courses": "Kurse të Regjistruar",
        "enrolled_students": "Studentë të Regjistruar",
        "courses_taught_count": "Kurse të Mësuara",
        "course": "Kurs",
        
        // Loading and error messages
        "loading_course_details": "Duke ngarkuar detajet e kursit...",
        "loading_student_details": "Duke ngarkuar detajet e kurseve të studentit...",
        "loading_professor_details": "Duke ngarkuar detajet e kurseve të profesorit...",
        "error_loading": "Gabim gjatë ngarkimit të detajeve:",
        "error": "Gabim:",
        
        // Logout
        "logout": "Dilni",
        "logout_with_user": "Dilni\n({name} - {role})",
        "role_admin": "Admin",
        "role_student": "Student"
    }
};

// Language management
let currentLanguage = 'en';

// Function to change language
function changeLanguage(lang) {
    currentLanguage = lang;
    localStorage.setItem('selectedLanguage', lang);
    updatePageContent();
}

// Function to translate text
function t(key) {
    return translations[currentLanguage][key] || translations['en'][key] || key;
}

// Function to update page content
function updatePageContent() {
    // Update header
    const headerText = document.querySelector('.header-text');
    if (headerText) headerText.textContent = t('uni_portal');
    
    const portalText = document.querySelector('.portal-text');
    if (portalText) portalText.textContent = t('uni_portal');
    
    const loginButton = document.getElementById('loginButton');
    if (loginButton) loginButton.textContent = t('login');
    
    // Update welcome section
    const welcomeTitle = document.querySelector('.welcome-title');
    if (welcomeTitle) welcomeTitle.textContent = t('welcome_title');
    
    const welcomeSubtitle = document.querySelector('.welcome-subtitle');
    if (welcomeSubtitle) welcomeSubtitle.textContent = t('welcome_subtitle');
    
    // Update page titles
    const pageTitle = document.querySelector('.page-title');
    if (pageTitle) {
        if (pageTitle.textContent.includes('Available Courses')) {
            pageTitle.textContent = t('available_courses');
        } else if (pageTitle.textContent.includes('Enrolled Students')) {
            pageTitle.textContent = t('students');
        } else if (pageTitle.textContent.includes('Faculty Professors')) {
            pageTitle.textContent = t('professors');
        }
    }
    
    // Update stats section
    const statLabels = document.querySelectorAll('.stat-label');
    if (statLabels.length >= 4) {
        statLabels[0].textContent = t('total_students');
        statLabels[1].textContent = t('available_courses');
        statLabels[2].textContent = t('professors');
        statLabels[3].textContent = t('enrollments');
    }
    
    // Update navigation menu items
    const navHome = document.querySelector('.nav-home');
    if (navHome) navHome.textContent = t('home');
    
    const navStudents = document.querySelector('.nav-students');
    if (navStudents) navStudents.textContent = t('students');
    
    const navCourses = document.querySelector('.nav-courses');
    if (navCourses) navCourses.textContent = t('courses');
    
    const navGrades = document.querySelector('.nav-grades');
    if (navGrades) navGrades.textContent = t('grades');
    
    const navProfessor = document.querySelector('.nav-professor');
    if (navProfessor) navProfessor.textContent = t('professor');
    
    const navContact = document.querySelector('.nav-contact');
    if (navContact) navContact.textContent = t('contact');
    
    // Update navigation grid
    const gridTitles = document.querySelectorAll('.grid-item-title');
    const gridSubtitles = document.querySelectorAll('.grid-item-subtitle');
    
    if (gridTitles.length >= 6) {
        gridTitles[0].textContent = t('home');
        gridTitles[1].textContent = t('students');
        gridTitles[2].textContent = t('courses');
        gridTitles[3].textContent = t('grades');
        gridTitles[4].textContent = t('professor');
        gridTitles[5].textContent = t('contact');
    }
    
    if (gridSubtitles.length >= 6) {
        gridSubtitles[0].textContent = t('home_subtitle');
        gridSubtitles[1].textContent = t('students_subtitle');
        gridSubtitles[2].textContent = t('courses_subtitle');
        gridSubtitles[3].textContent = t('grades_subtitle');
        gridSubtitles[4].textContent = t('professor_subtitle');
        gridSubtitles[5].textContent = t('contact_subtitle');
    }
    
    // Update table headers
    const thCourseId = document.querySelector('.th-course-id');
    if (thCourseId) thCourseId.textContent = t('course_id');
    
    const thCourseName = document.querySelector('.th-course-name');
    if (thCourseName) thCourseName.textContent = t('course_name');
    
    const thCredits = document.querySelector('.th-credits');
    if (thCredits) thCredits.textContent = t('credits');
    
    const thEnrolled = document.querySelector('.th-enrolled');
    if (thEnrolled) thEnrolled.textContent = t('enrolled_students');
    
    // Student page table headers
    const thStudentId = document.querySelector('.th-student-id');
    if (thStudentId) thStudentId.textContent = t('student_id');
    
    const thFullName = document.querySelector('.th-full-name');
    if (thFullName) thFullName.textContent = t('full_name');
    
    const thEmail = document.querySelector('.th-email');
    if (thEmail) thEmail.textContent = t('email');
    
    const thEnrollmentYear = document.querySelector('.th-enrollment-year');
    if (thEnrollmentYear) thEnrollmentYear.textContent = t('enrollment_year');
    
    const thCourses = document.querySelector('.th-courses');
    if (thCourses) thCourses.textContent = t('courses');
    
    // Professor page table headers
    const thProfessorId = document.querySelector('.th-professor-id');
    if (thProfessorId) thProfessorId.textContent = t('professor_id');
    
    const thDepartment = document.querySelector('.th-department');
    if (thDepartment) thDepartment.textContent = t('department');
    
    const thCoursesTaught = document.querySelector('.th-courses-taught');
    if (thCoursesTaught) thCoursesTaught.textContent = t('courses_taught');
    
    // Update view buttons
    const viewButtons = document.querySelectorAll('.view-btn-text');
    viewButtons.forEach(button => {
        button.textContent = t('view');
    });
    
    // Update modal titles
    const modalTitle = document.querySelector('.modal-title');
    if (modalTitle) {
        if (modalTitle.textContent.includes('Course Details')) {
            modalTitle.textContent = t('course_details');
        } else if (modalTitle.textContent.includes('Student Course Details')) {
            modalTitle.textContent = t('student_course_details');
        } else if (modalTitle.textContent.includes('Professor Course Details')) {
            modalTitle.textContent = t('professor_course_details');
        }
    }
    
    // Update footer
    const footerCopyright = document.querySelector('.footer-copyright');
    if (footerCopyright) footerCopyright.textContent = t('copyright');
    
    // Update logout button
    const logoutText = document.querySelector('.logout-text');
    if (logoutText) {
        if (Auth.isLoggedIn()) {
            const user = Auth.getUser();
            const userName = user?.firstName || user?.email || 'User';
            const userRole = user?.role || 'User';
            
            // Translate role
            let translatedRole;
            if (userRole.toLowerCase() === 'admin') {
                translatedRole = t('role_admin');
            } else if (userRole.toLowerCase() === 'student') {
                translatedRole = t('role_student');
            } else {
                translatedRole = userRole;
            }
            
            // Use the template with user info
            const logoutTemplate = t('logout_with_user');
            logoutText.textContent = logoutTemplate
                .replace('{name}', userName)
                .replace('{role}', translatedRole);
        } else {
            logoutText.textContent = t('logout');
        }
    }
    
    // Update document title
    const currentPage = window.location.pathname;
    if (currentPage.includes('home.php') || currentPage === '/') {
        document.title = t('uni_portal') + ' - Home';
    } else if (currentPage.includes('courses_page.php')) {
        document.title = t('courses') + ' - ' + t('uni_portal');
    } else if (currentPage.includes('student_page.php')) {
        document.title = t('students') + ' - ' + t('uni_portal');
    } else if (currentPage.includes('professor_page.php')) {
        document.title = t('professors') + ' - ' + t('uni_portal');
    }
}

// Initialize language on page load
document.addEventListener('DOMContentLoaded', function() {
    const savedLanguage = localStorage.getItem('selectedLanguage');
    if (savedLanguage && translations[savedLanguage]) {
        currentLanguage = savedLanguage;
    }
    updatePageContent();
});
